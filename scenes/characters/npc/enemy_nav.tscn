[gd_scene load_steps=31 format=3 uid="uid://byuq1gtkgjlxk"]

[ext_resource type="Script" uid="uid://cyhaw1qyjtrhn" path="res://blisscode/character/character_controller.gd" id="1_84kvi"]
[ext_resource type="Script" uid="uid://bkcl7yhvmiokh" path="res://blisscode/character/character_sheet.gd" id="2_cp2oj"]
[ext_resource type="Script" uid="uid://ej3t1d08m43w" path="res://blisscode/item/inventory.gd" id="3_7d3s6"]
[ext_resource type="Script" uid="uid://drotf454prdmb" path="res://blisscode/item/item.gd" id="3_pss33"]
[ext_resource type="Script" uid="uid://cwaaqivnrog6d" path="res://blisscode/item/equipment.gd" id="4_ea2ym"]
[ext_resource type="Script" uid="uid://brschogihfiwm" path="res://blisscode/character/controls/ai_controls.gd" id="5_xntsm"]
[ext_resource type="Script" uid="uid://bnbbi7tcoi6sg" path="res://blisscode/behavior_tree/bt_blackboard.gd" id="15_m81vb"]
[ext_resource type="Script" uid="uid://b3mlg2cpf7tdl" path="res://blisscode/behavior_tree/bt_player.gd" id="16_d5clj"]
[ext_resource type="Script" uid="uid://dnm2cmvm2uh0v" path="res://blisscode/behavior_tree/composite/bt_selector_node.gd" id="17_8ydik"]
[ext_resource type="Script" uid="uid://xwbo18yggp15" path="res://blisscode/behavior_tree/composite/bt_sequence_node.gd" id="18_jevjy"]
[ext_resource type="Script" uid="uid://dok7jnwk51yxt" path="res://blisscode/behavior_tree/decorator/bt_inverter.gd" id="19_k5p27"]
[ext_resource type="Script" uid="uid://suq305es6w0d" path="res://blisscode/behavior_tree/condition/bt_has_target.gd" id="20_1c42r"]
[ext_resource type="Script" uid="uid://cd4i1bii75shv" path="res://blisscode/behavior_tree/action/bt_remove_var.gd" id="21_bgrqk"]
[ext_resource type="Script" uid="uid://blst147vnwxru" path="res://blisscode/behavior_tree/action/bt_move_to_random_polygon_pos.gd" id="22_cp2oj"]
[ext_resource type="Script" uid="uid://cfip3tt42agy6" path="res://blisscode/behavior_tree/action/bt_set_direction_from_move_to.gd" id="23_4e28t"]
[ext_resource type="Script" uid="uid://dhn4xcjw813bf" path="res://blisscode/behavior_tree/action/bt_navigation_agent_set_target_pos.gd" id="23_7d3s6"]
[ext_resource type="Script" uid="uid://bt4wgiw1ej6cx" path="res://blisscode/behavior_tree/action/bt_navigation_process.gd" id="24_ea2ym"]
[ext_resource type="Script" uid="uid://c4yfy880i0n7v" path="res://blisscode/behavior_tree/action/bt_move_to_target.gd" id="25_qug7d"]
[ext_resource type="Script" uid="uid://d03t847j337hs" path="res://blisscode/behavior_tree/action/bt_set_var.gd" id="26_8hin7"]
[ext_resource type="PackedScene" uid="uid://qduhqb6f8ovy" path="res://scenes/characters/ui/character_points_bar.tscn" id="27_04d0s"]
[ext_resource type="Script" uid="uid://c30av3xht06qh" path="res://blisscode/character/debug_label.gd" id="28_cp2oj"]
[ext_resource type="Script" uid="uid://ddbwnppuvd6sh" path="res://blisscode/area/target_area.gd" id="28_q6lr5"]

[sub_resource type="Resource" id="Resource_urpkq"]
resource_local_to_scene = true
script = ExtResource("2_cp2oj")
character_name = "Enemy 1"
character_controller_type = 1
race = 3
class_type = 4
alignment = 0.0
level = 0
health = 10
max_health = 10
armor = 0
max_armor = 0
mana = 0
max_mana = 0
stamina = 0
max_stamina = 0
special = 0
max_special = 0
xp = 0
max_xp = 0
strength = 0
dexterity = 0
constitution = 0
intelligence = 0
wisdom = 0
charisma = 0
attack = 0
metadata/_custom_type_script = "uid://bkcl7yhvmiokh"

[sub_resource type="Resource" id="Resource_wwum6"]
resource_local_to_scene = true
script = ExtResource("3_7d3s6")
gold = 0
max_gold = 10000
max_slots = 50
items = Array[ExtResource("3_pss33")]([])
metadata/_custom_type_script = "uid://ej3t1d08m43w"

[sub_resource type="Resource" id="Resource_lwmd7"]
resource_local_to_scene = true
script = ExtResource("4_ea2ym")
left_hand = "guns_3"
metadata/_custom_type_script = "uid://cwaaqivnrog6d"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_84hc2"]

[sub_resource type="Gradient" id="Gradient_rp718"]
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_bgitj"]
gradient = SubResource("Gradient_rp718")

[sub_resource type="CircleShape2D" id="CircleShape2D_mm6pg"]
radius = 202.022

[sub_resource type="NavigationPolygon" id="NavigationPolygon_84kvi"]
vertices = PackedVector2Array(188.039, -101.07, 188.953, 100.922, -180, 98.0703, -180, -103.922)
polygons = Array[PackedInt32Array]([PackedInt32Array(0, 1, 2, 3)])
outlines = Array[PackedVector2Array]([PackedVector2Array(-190, -114, -190, 108, 199, 111, 198, -111)])

[node name="EnemyNav" type="CharacterBody2D" node_paths=PackedStringArray("controls", "navigation_agent") groups=["enemy"]]
collision_layer = 64
collision_mask = 103
motion_mode = 1
script = ExtResource("1_84kvi")
character_sheet = SubResource("Resource_urpkq")
inventory = SubResource("Resource_wwum6")
equipment = SubResource("Resource_lwmd7")
controls = NodePath("AIControls")
allow_y_controls = true
navigation_agent = NodePath("NavigationRegion2D/NavigationAgent2D")
garbage = true
garbage_time = 0.1
metadata/_custom_type_script = "uid://cyhaw1qyjtrhn"

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("RectangleShape2D_84hc2")

[node name="Sprite2D" type="Sprite2D" parent="."]
position = Vector2(-3.8147e-06, 0)
scale = Vector2(0.078125, 20)
texture = SubResource("GradientTexture1D_bgitj")

[node name="AIControls" type="Node" parent="." node_paths=PackedStringArray("blackboard")]
script = ExtResource("5_xntsm")
blackboard = NodePath("../BTBlackboard")
metadata/_custom_type_script = "uid://brschogihfiwm"

[node name="BTBlackboard" type="Node" parent="."]
script = ExtResource("15_m81vb")
metadata/_custom_type_script = "uid://bnbbi7tcoi6sg"

[node name="BTPlayer" type="Node" parent="." node_paths=PackedStringArray("root_node", "blackboard", "agent")]
script = ExtResource("16_d5clj")
root_node = NodePath("BTSelectorNode")
blackboard = NodePath("../BTBlackboard")
agent = NodePath("..")
is_running = true
metadata/_custom_type_script = "uid://b3mlg2cpf7tdl"

[node name="BTSelectorNode" type="Node" parent="BTPlayer"]
script = ExtResource("17_8ydik")
metadata/_custom_type_script = "uid://dnm2cmvm2uh0v"

[node name="Wander" type="Node" parent="BTPlayer/BTSelectorNode"]
script = ExtResource("18_jevjy")
metadata/_custom_type_script = "uid://xwbo18yggp15"

[node name="BTInverterIfDontHave" type="Node" parent="BTPlayer/BTSelectorNode/Wander"]
script = ExtResource("19_k5p27")
metadata/_custom_type_script = "uid://dok7jnwk51yxt"

[node name="BTHasTarget" type="Node" parent="BTPlayer/BTSelectorNode/Wander/BTInverterIfDontHave"]
script = ExtResource("20_1c42r")
metadata/_custom_type_script = "uid://suq305es6w0d"

[node name="BTRemoveLeftHand" type="Node" parent="BTPlayer/BTSelectorNode/Wander"]
script = ExtResource("21_bgrqk")
var_name = &"left_hand"

[node name="BTMoveToRandomPolygonPos" type="Node" parent="BTPlayer/BTSelectorNode/Wander"]
script = ExtResource("22_cp2oj")

[node name="BTNavigationAgentSetMoveTo" type="Node" parent="BTPlayer/BTSelectorNode/Wander"]
script = ExtResource("23_7d3s6")

[node name="BTSetDirectionFromMoveTo" type="Node" parent="BTPlayer/BTSelectorNode/Wander"]
script = ExtResource("23_4e28t")
metadata/_custom_type_script = "uid://cfip3tt42agy6"

[node name="BTNavigationProcess" type="Node" parent="BTPlayer/BTSelectorNode/Wander"]
script = ExtResource("24_ea2ym")
acquire_target = true

[node name="Attack" type="Node" parent="BTPlayer/BTSelectorNode"]
script = ExtResource("18_jevjy")
metadata/_custom_type_script = "uid://xwbo18yggp15"

[node name="BTHasTarget" type="Node" parent="BTPlayer/BTSelectorNode/Attack"]
script = ExtResource("20_1c42r")
metadata/_custom_type_script = "uid://suq305es6w0d"

[node name="BTMoveToTarget" type="Node" parent="BTPlayer/BTSelectorNode/Attack"]
script = ExtResource("25_qug7d")
metadata/_custom_type_script = "uid://c4yfy880i0n7v"

[node name="BTSetVarLeftHand" type="Node" parent="BTPlayer/BTSelectorNode/Attack"]
script = ExtResource("26_8hin7")
var_name = &"left_hand"
value = true
metadata/_custom_type_script = "uid://d03t847j337hs"

[node name="BTNavigationAgentSetMoveTo" type="Node" parent="BTPlayer/BTSelectorNode/Attack"]
script = ExtResource("23_7d3s6")

[node name="BTSetDirectionFromMoveTo" type="Node" parent="BTPlayer/BTSelectorNode/Attack"]
script = ExtResource("23_4e28t")
metadata/_custom_type_script = "uid://cfip3tt42agy6"

[node name="BTNavigationProcess" type="Node" parent="BTPlayer/BTSelectorNode/Attack"]
script = ExtResource("24_ea2ym")
require_target = true

[node name="CharacterPointsBar" parent="." node_paths=PackedStringArray("character") instance=ExtResource("27_04d0s")]
character = NodePath("..")

[node name="DebugLabel" type="Label" parent="." node_paths=PackedStringArray("controls")]
offset_left = -10.0
offset_top = -56.0
offset_right = 30.0
offset_bottom = -24.0
theme_override_constants/line_spacing = -9
theme_override_font_sizes/font_size = 16
text = "State
Position"
script = ExtResource("28_cp2oj")
controls = NodePath("../AIControls")

[node name="TargetArea" type="Area2D" parent="." node_paths=PackedStringArray("blackboard")]
collision_layer = 0
script = ExtResource("28_q6lr5")
group = &"player"
blackboard = NodePath("../BTBlackboard")
metadata/_custom_type_script = "uid://ddbwnppuvd6sh"

[node name="CollisionShape2D" type="CollisionShape2D" parent="TargetArea"]
shape = SubResource("CircleShape2D_mm6pg")

[node name="NavigationRegion2D" type="NavigationRegion2D" parent="."]
navigation_polygon = SubResource("NavigationPolygon_84kvi")

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="NavigationRegion2D"]
debug_enabled = true
